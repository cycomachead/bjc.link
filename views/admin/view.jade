extends ../layouts/layout.jade

- var title = `Details ${key} | ${options.APP_NAME}`

block content
  div.container-fluid
    h2
      code #{key}
      | &nbsp; Detials
    div.table-responsive
      table.table.table-striped.table-bordered
        tbody
         tr
           th Key
           td
             a(href='/#{key}' target='_blank') #{key}
         tr
           th URL
           td
             a(href=url)=url
         tr
           th Clicks
           td #{count}
         tr
           th Created At
           td #{created_at}
        tr
          th Created By
          td #{created_by}
        tr
          th Show Stats By
          td
            select#groupingOption
              for item in select_options
                option(id=item.value, value=item.value)
                  | #{item.text}

    div#chart.clicksChart

    script(src="/assets/js/Chart.bundle.min.js")
    script(src="/assets/js/chartkick.js")
    script(type='text/javascript').
      window.onload = function () {
        new Chartkick.ColumnChart(
          "chart",
          location.pathname + "/visits" + location.search,
          { xtitle: "#{group_by}", ytitle: "Clicks" }
        );

        $('#groupingOption').val('#{group_by}');

        document.getElementById('groupingOption').onchange = function () {
          window.location = location.pathname + '?group_by=' + this.value;
        };
      }